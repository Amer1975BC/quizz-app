/* minimal client script (already present in repo if committed) */
async function api(path, opts={}){const res=await fetch(path,Object.assign({headers:{'Content-Type':'application/json'}},opts));if(!res.ok)throw new Error(await res.text());return res.json().catch(()=>null);}
const startBtn=document.getElementById('startBtn'), qArea=document.getElementById('questionArea'), qText=document.getElementById('qText'), choices=document.getElementById('choices'), resultArea=document.getElementById('resultArea'), progress=document.getElementById('progress');
startBtn.onclick=async()=>{await api('/api/start',{method:'POST'});startBtn.style.display='none';qArea.style.display='block';loadQuestion()};
async function loadQuestion(){const data=await api('/api/question'); if(data.finished){showResult();return;} qText.innerText=data.question.question; choices.innerHTML=''; data.question.choices.forEach((c,i)=>{const li=document.createElement('li'); const btn=document.createElement('button'); btn.innerText=c; btn.onclick=()=>submitAnswer(i,btn); li.appendChild(btn); choices.appendChild(li);}); progress.innerText=`Vraag ${data.index+1} / ${data.total}`;}
async function submitAnswer(choice, btn){Array.from(choices.querySelectorAll('button')).forEach(b=>b.disabled=true); const data=await api('/api/answer',{method:'POST', body: JSON.stringify({choice})}); if(data.finished){showResult();} else {setTimeout(()=>loadQuestion(),700);}}
async function showResult(){const r=await api('/api/result'); qArea.style.display='none'; resultArea.style.display='block'; resultArea.innerHTML=`<h2>Klaar!</h2><p>Je score: ${r.score} / ${r.total}</p><button id="restart">Nog een keer</button>`; document.getElementById('restart').onclick=()=>{startBtn.style.display='inline-block'; resultArea.style.display='none'}}
